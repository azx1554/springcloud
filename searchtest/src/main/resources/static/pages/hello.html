<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="/static/css/layui.css">
</head>
<body>
    <div class="layui-main">
    <form class="layui-form"> <!-- 提示：如果你不想用form，你可以换成div等任何一个普通元素 -->
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">企业名称</label>
                <div class="layui-input-inline">
                    <input type="text" name="name" required  placeholder="关键词模糊查询" autocomplete="off" class="layui-input">
                </div>
                <label class="layui-form-label">法人</label>
                <div class="layui-input-inline">
                    <input type="text" name="legalPerson" required  placeholder="法人" autocomplete="off" class="layui-input">
                </div>
                <label class="layui-form-label">企业地址</label>
                <div class="layui-input-inline">
                    <input type="text" name="address" required  placeholder="企业地址模糊查询" autocomplete="off" class="layui-input">
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">所属省份</label>
                <div class="layui-input-inline">
                    <select name="province">
                        <option value="0">广东省</option>
                    </select>
                </div>
                <label class="layui-form-label">所属城市</label>
                <div class="layui-input-inline">
                    <select name="city">
                        <option value="0">珠海市</option>
                    </select>
                </div>
                <label class="layui-form-label">所属地区</label>
                <div class="layui-input-inline">
                    <select name="area">
                        <option value="">请选择</option>
                        <option value="金湾区">金湾区</option>
                        <option value="香洲区">香洲区</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">所属行业</label>
                <div class="layui-input-inline">
                    <select name="industry">
                        <option value="">请选择</option>
                        <option value="商务服务业">商务服务业</option>
                        <option value="批发业">批发业</option>
                        <option value="计算机、通信和其他电子设备制造业">计算机、通信和其他电子设备制造业</option>
                        <option value="专业技术服务业">专业技术服务业</option>
                        <option value="研究和试验发展">研究和试验发展</option>
                        <option value="电气机械和器材制造业">电气机械和器材制造业</option>
                        <option value="科学研究和技术服务业">科学研究和技术服务业</option>
                        <option value="仪器仪表制造业">仪器仪表制造业</option>
                    </select>
                </div>
                <label class="layui-form-label">企业状态</label>
                <div class="layui-input-inline">
                    <select name="state">
                        <option value="">请选择</option>
                        <option value="在业">在业</option>
                        <option value="迁出">迁出</option>
                        <option value="吊销">吊销</option>
                    </select>
                </div>
                <label class="layui-form-label">参保人数</label>
                <div class="layui-input-inline">
                    <input type="text" name="insuredCountBegin" required  placeholder="个" autocomplete="off" class="layui-input" style="width: 50px;float: left">
                    <label class="layui-form-label" style="float: left;width: 20px"> --- </label>
                    <input type="text" name="insuredCountEnd" required  placeholder="个" autocomplete="off" class="layui-input" style="width: 50px">
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">是否有官网</label>
                <div class="layui-input-inline">
                    <input type="checkbox" name="website" lay-skin="primary" id="website">
                </div>
                <label class="layui-form-label">企业类型</label>
                <div class="layui-input-inline">
                    <select name="type">
                        <option value="">请选择</option>
                        <option value="有限责任公司(自然人独资)">有限责任公司(自然人独资)</option>
                        <option value="有限责任公司(自然人投资或控股)">有限责任公司(自然人投资或控股)</option>
                        <option value="股份有限公司(上市、自然人投资或控股)">股份有限公司(上市、自然人投资或控股)</option>
                        <option value="股份有限公司(非上市、自然人投资或控股)">股份有限公司(非上市、自然人投资或控股)</option>
                        <option value="其他股份有限公司(非上市)">其他股份有限公司(非上市)</option>
                    </select>
                </div>
                <label class="layui-form-label">注册资本</label>
                <div class="layui-input-inline">
                    <input type="text" name="capitalBegin" required  placeholder="万元" autocomplete="off" class="layui-input" style="width: 70px;float: left">
                    <label class="layui-form-label" style="float: left;width: 20px"> --- </label>
                    <input type="text" name="capitalCountEnd" required  placeholder="万元" autocomplete="off" class="layui-input" style="width: 70px">
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">注册日期</label>
                <div class="layui-input-inline">
                    <input type="text" class="layui-input" id="registDateStart" style="float: left">
                </div>
                <label class="layui-form-label">---------------</label>
                <div class="layui-input-inline">
                    <input type="text" class="layui-input" id="registDateEnd">
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-input-block">
                <button class="layui-btn" lay-submit lay-filter="formDemo">搜索</button>
                <button type="reset" class="layui-btn layui-btn-primary">重置</button>
            </div>
        </div>
    </form>


    <table id="demo" lay-filter="test"></table>

    </div>

    <script src="../jquery-1.12.0.js"></script>
    <script src="../layui.all.js"></script>
    <script>
        var table = layui.table;
        //第一个实例
        table.render({
            elem: '#demo',
            //, height: 600
            url: '/searchTest/search',
            method: 'post',
            contentType: 'application/json',
            //,page: true //开启分页
            cols: [[ //表头
                {field: 'id', title: 'ID', width: 80, sort: true, fixed: 'left', hide: true}
                , {field: 'name', title: '企业名称', width: 200}
                , {field: 'province', title: '所属省份', width: 90}
                , {field: 'city', title: '所属城市', width: 90}
                , {field: 'area', title: '所属地区', width: 90}
                , {field: 'legal_person', title: '法人', width: 80, sort: true}
                , {field: 'capital', title: '注册资本(万)', width: 120, sort: true}
                , {field: 'type', title: '企业类型', width: 200, sort: true}
                , {field: 'state', title: '企业状态', width: 90}
                , {field: 'start_date', title: '注册日期', width: 115, templet: '#titleTpl', sort: true}
                , {field: 'address', title: '地址', width: 300}
                , {field: 'industry', title: '所属行业', width: 150}
                , {field: 'insured_count', title: '参保人数', width: 100, sort: true}
                , {field: 'website', title: '官网', width: 200}
            ]],
            parseData: function(res) {
                return {
                    "code": 0, //解析接口状态
                    "msg": 'success', //解析提示文本
                    "count": res.length, //解析数据长度
                    "data": res //解析数据列表
                };
            },
            data: [
                {
                    id: 1, name: 1, province: 1, city: 1, area: 1, legalPerson: 1
                }
            ]
        });

        var laydate = layui.laydate;
        laydate.render({
            elem: '#registDateStart', //指定元素
            done: function(value, date, endDate){
                $("#registDateStart").val(value);
            }
        });
        laydate.render({
            elem: '#registDateEnd', //指定元素
            done: function(value, date, endDate){
                $("#registDateEnd").val(value);
            }
        });

        var form = layui.form;
        //监听提交
        form.on('submit(formDemo)', function (data) {
            var checked = $("#website").prop('checked');
            var registDateStart = $("#registDateStart").val();
            var registDateEnd = $("#registDateEnd").val();
            //var conditon = JSON.stringify(data.field);
            data.field.website = checked;
            data.field.registDateStart = registDateStart;
            data.field.registDateEnd = registDateEnd;
            table.reload('demo', {
                url: '/searchTest/search',
                where: data.field, //设定异步数据接口的额外参数
                method: 'post',
                contentType: 'application/json',
                parseData: function(res) { //res 即为原始返回的数据
                    console.log(res);
                    return {
                        "code": 0, //解析接口状态
                        "msg": 'success', //解析提示文本
                        "count": res.length, //解析数据长度
                        "data": res //解析数据列表
                    };
                }
            });
            return false;
        });

    </script>

    <script type="text/html" id="titleTpl">
        {{#
            function formatDate(dateString) {
                var date = new Date(dateString);
                var seperator1 = "-";
                var year = date.getFullYear();
                var month = date.getMonth() + 1;
                var strDate = date.getDate();
                if (month >= 1 && month <= 9) {
                    month = "0" + month;
                }
                if (strDate >= 0 && strDate <= 9) {
                    strDate = "0" + strDate;
                }
                var currentdate = year + seperator1 + month + seperator1 + strDate;
                return currentdate;
            }
        }}
        {{ formatDate(d.start_date) }}
    </script>
</body>
</html>